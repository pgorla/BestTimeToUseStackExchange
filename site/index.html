<!doctype html>

<html>

<head>

<meta charset="utf-8">
<script src="js/jquery.js"></script>
<script src="http://ajax.googleapis.com/ajax/libs/jqueryui/1.8/jquery-ui.min.js"></script>

<script src="js/d3.js"></script>

<!--
<script src="js/ajax-solr/lib/core/Core.js"></script>
<script src="js/ajax-solr/lib/core/AbstractManager.js"></script>
<script src="js/ajax-solr/lib/managers/Manager.jquery.js"></script>
-->

<!--<link rel="stylesheet" type="text/css" href="css/bootstrap.css" />-->
<link href="http://ajax.googleapis.com/ajax/libs/jqueryui/1.8/themes/base/jquery-ui.css" rel="stylesheet" type="text/css"/>

<style>



</style>

<script>

function draw(data) {
    "use strict";

    window.docs = data.response.docs;

    var margin = 50,
        width = 900 - margin,
        height = 500 - margin;

    var time_parse = d3.time.format("%H:%M").parse;

    var y_scale = d3.time.scale.utc()
        .domain([time_parse("00:00"), time_parse("23:59")])
        .range([0, height]);

    // We don't use the extent function to keep all days on the axis,
    // even the ones not represented in the dataset.
    var x_scale = d3.scale.linear()
        .domain([0,7])
        .range([margin, width]);

    var rad_extent = d3.extent(
        data.response.docs,
        function(d) {
            return d.AnswerCount;
        });

    var rad_scale = d3.scale.linear()
        .domain(rad_extent)
        .range([5,25]);

    var x_axis = d3.svg.axis().scale(x_scale);

    var y_axis = d3.svg.axis()
        .scale(y_scale)
        .orient("left");

    d3.select("body")
        .append("svg")
            .attr("width", width+margin)
            .attr("height", height+margin)
            .attr("class", "chart");

    d3.select("svg")
        .selectAll("circle")
        .data(data.response.docs)
        .enter()
        .append("circle")
            .attr("class", "main");

   d3.selectAll("circle")
        .attr("cy", function(d){
            var time = new Date(d.CreationDate);
            var _time = time.getUTCHours() + ":" + time.getUTCMinutes();
            return y_scale(time_parse(_time))})
        .attr("cx", function(d){
            return x_scale(new Date(d.CreationDate).getDay())})
        .attr("r", function(d){return rad_scale(d.AnswerCount)});

    d3.select("svg")
        .append("g")
        .attr("class", "x axis")
        .attr("transform", "translate(0," + height + ")")
        .call(x_axis);

    d3.select("svg")
        .append("g")
        .attr("class", "y axis")
        .attr("transform", "translate(" + margin + ",0)")
        .call(y_axis);

}

</script>
 

</head>

<body>

<script>

d3.json("sample.json", draw);

</script>
 
</body>
</html>

